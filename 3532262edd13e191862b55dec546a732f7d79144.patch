From 3532262edd13e191862b55dec546a732f7d79144 Mon Sep 17 00:00:00 2001
From: Diven Qi <diven.qi@zoom.us>
Date: Mon, 7 Sep 2020 17:30:04 +0800
Subject: [PATCH] url: use blank credentials when using proxy w/o username and
 password

Fixes proxy regression brought in commit ad829b21ae (7.71.0)

Fixed #5911
Closes #5914
---
 lib/url.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/lib/url.c b/lib/url.c
index b3884572d62..af2a1c06dd5 100644
--- a/lib/url.c
+++ b/lib/url.c
@@ -2379,8 +2379,10 @@ static CURLcode parse_proxy(struct Curl_easy *data,
 static CURLcode parse_proxy_auth(struct Curl_easy *data,
                                  struct connectdata *conn)
 {
-  char *proxyuser = data->set.str[STRING_PROXYUSERNAME];
-  char *proxypasswd = data->set.str[STRING_PROXYPASSWORD];
+  const char *proxyuser = data->set.str[STRING_PROXYUSERNAME] ?
+    data->set.str[STRING_PROXYUSERNAME] : "";
+  const char *proxypasswd = data->set.str[STRING_PROXYPASSWORD] ?
+    data->set.str[STRING_PROXYPASSWORD] : "";
   CURLcode result = CURLE_OK;
 
   if(proxyuser)
